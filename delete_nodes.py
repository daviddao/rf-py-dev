from ete2 import Tree
from read_drops import *
import sys

'''
This function takes a set of small trees and delete a list of leaves
'''


def delete(file, target_file, taxa):
    f = open(file)
    t_file = open(target_file, "w")

    count = 0

    for line in f:
        # print "looking at tree", count
        line = line.strip().split("=")
        t = Tree(line[1])
        for taxon in taxa:
            leaves = t.get_leaves_by_name(name=taxon)
            for leaf in leaves:
                leaf.delete()
        if len(t) < 3:
            pass
        else:
            # prevent falsy trees for RAxML
            while len(t.children) == 1:
                t = t.children[0]

            # write it into the file
            t_file.write(line[0] + "=" + t.write() + "\n")
        count += 1
        print(count)

    f.close()
    t_file.close()

    # TODO: error sorting!

file = sys.argv[1]
file = str(file)
target_file = sys.argv[2]
target_file = str(target_file)

# prune = read_drops("./data/result.txt", "./data/names.txt", 10)
# prune = ['Picea_rubens','Picea_torano','Picea_maximowiczii','Aegilops_sharonensis','Aegilops_speltoides','Dasypyrum_villosum','Cupressus_austrotibetica','Tetraclinis_articulata','Potamogeton_wrightii','Potamogeton_distinctus','Potamogeton_obtusifolius','Pleioblastus_gramineus','Phyllostachys_nigra','Guadua_angustifolia','Pinus_koraiensis','Pinus_cembra','Encephalartos_princeps','Encephalartos_senticosus','Encephalartos_natalensis','Rehdera_trinervis','Phyla_lanceolata','Jubaea_chilensis','Lytocaryum_weddellianum','Polyandrococos_caudescens','Osmanthus_yunnanensis','Osmanthus_marginatus','Phillyrea_latifolia','Hordeum_pusillum','Heteranthelium_piliferum','Picea_alcoquiana','Picea_glehnii','Dendrobium_wardianum','Dendrobium_gibsonii','Solanum_pennellii','Solanum_habrochaites','Oryza_latifolia','Oryza_eichingeri','Oligostachyum_sulcatum','Brachystachyum_densiflorum','Lithospermum_multiflorum','Lithospermum_mirabile','Fragaria_pentaphylla','Fragaria_nubicola','Cycas_revoluta','Bowenia_spectabilis','Dioon_spinulosum','Neurolepis_elata','Pleioblastus_simonii','Shibataea_kumasaca','Stylosanthes_hamata','Stylosanthes_mexicana','Larix_laricina','Larix_occidentalis','Citrus_aurantiifolia','Citrus_medica','Hopea_mengarawan','Hopea_helferi','Hordeum_marinum','Hordeum_brachyantherum','Hordeum_arizonicum','Encephalartos_villosus','Encephalartos_lanatus','Encephalartos_inopinus','Encephalartos_gratus','Encephalartos_ghellinckii','Dendrobium_brymerianum','Dendrobium_fimbriatum','Coffea_eugenioides','Coffea_liberica','Eragrostis_weberbaueri','Eragrostis_tenuifolia','Ceratozamia_kuesteriana','Ceratozamia_euryphyllidia','Ceratozamia_norstogii','Manihot_anomala','Manihot_fruticulosa','Manihot_chlorosticta','Glyceria_grandis','Glyceria_declinata','Schizostachyum_funghomii','Menstruocalamus_sichuanensis','Phyllostachys_edulis','Hydriastele_pinangoides','Astrocaryum_alatum','Lycium_bosciifolium','Lycium_ferocissimum','Echidnopsis_leachii','Caralluma_bhupinderana','Passiflora_citrifolia','Passiflora_foetida','Thujopsis_dolabrata','Thuja_plicata','Protea_effusa','Protea_laurifolia','Nuphar_advena','Nuphar_rubrodisca','Primula_bulleyana','Primula_cockburniana','Bambusa_bambos','Neosinocalamus_affinis','Monocladus_saxatilis','Myricaria_wardii','Myricaria_laxiflora','Sinapis_alba','Brassica_juncea','Austrodanthonia_tenuior','Austrodanthonia_fulva','Austrodanthonia_laevis','Pseudopentameris_macrantha','Notodanthonia_longifolia','Potamogeton_gramineus','Potamogeton_natans','Euryops_speciosissimus','Euryops_virgineus','Crucihimalaya_mollissima','Boechera_holboellii','Avena_ventricosa','Avena_sativa','Encephalartos_laevifolius','Encephalartos_trispinosus','Encephalartos_heenanii','Encephalartos_woodii','Encephalartos_latifrons','Hesperolinon_micranthum','Hesperolinon_clevelandii','Austrodanthonia_mera','Austrodanthonia_popinensis','Austrodanthonia_duttoniana','Vitis_thunbergii','Vitis_davidii','Gossypium_barbadense','Gossypium_mustelinum','Castanea_sativa','Castanea_mollissima','Salix_viminalis','Salix_purpurea','Salix_lucida','Phytelephas_schottii','Phytelephas_tenuicaulis','Lychnis_coronaria','Silene_conica','Kohleria_spicata','Sinningia_cooperi','Dioon_sonorense','Dioon_argenteum','Malacomeles_denticulata','Eriobotrya_japonica','Malus_trilobata','Potamogeton_dentatus','Potamogeton_lucens','Neotinea_maculata','Orchis_quadripunctata','Himantoglossum_robertianum','Cocos_nucifera','Syagrus_glaucescens','Rhipsalis_paradoxa','Lepismium_cruciforme','Veronica_thessalica','Veronica_saturejoides','Osmanthus_attenuatus','Osmanthus_delavayi','Doronicum_stenoglossum','Doronicum_dolichotrichum','Doronicum_haussknechtii','Prunus_murrayana','Prunus_maritima','Eleocharis_marginulata','Eleocharis_vivipara','Eleocharis_gracilis','Leersia_tisserantii','Oryza_brachyantha','Oryza_granulata','Hyalopoa_lanatiflora','Poa_glauca','Echium_onosmifolium','Echium_handiense','Echium_pininana','Flaveria_ramosissima','Flaveria_palmeri','Polystachya_ottoniana','Polystachya_pubescens','Austrodanthonia_induta','Austrodanthonia_monticola','Hordeum_pubiflorum','Hordeum_fuegianum','Ipomoea_ramosissima','Ipomoea_tenuissima','Ipomoea_tiliacea','Potamogeton_berchtoldii','Stuckenia_pectinata','Dolichothrix_ericoides','Trichogyne_repens','Arnica_longifolia','Arnica_unalaschcensis','Atractylodes_lancea','Atractylodes_japonica','Aesculus_tsiangii','Aesculus_chinensis','Avena_hirtula','Avena_abyssinica','Avena_strigosa','Fouquieria_diguetii','Fouquieria_burragei','Fouquieria_splendens','Smelowskia_bifurcata','Smelowskia_porsildii','Smelowskia_calycina','Pseudoclappia_arenaria','Oxypappus_scaber','Citrus_reticulata','Citrus_tachibana','Citrus_jambhiri','Panicum_miliaceum','Panicum_pilosum','Typhonium_hirsutum','Typhonium_trilobatum','Typhonium_albidinervum','Rhytidophyllum_leucomallon','Gesneria_ventricosa','Centaurium_serpentinicola','Centaurium_capense','Prosopis_pallida','Prosopis_velutina','Magnolia_obovata','Magnolia_sieboldii','Lycium_americanum','Lycium_shockleyi','Psilanthus_wightianus','Coffea_kapakata','Coffea_abeokutae','Angelica_ampla','Angelica_sylvestris','Angelica_likiangensis','Lycoris_longituba','Lycoris_albiflora','Picea_mexicana','Picea_asperata','Picea_wilsonii','Melocalamus_arrectus','Himalayacalamus_intermedius','Podocarpus_neriifolius','Podocarpus_annamiensis','Lycium_barbarum','Lycium_europaeum','Solanum_lycopersicoides','Solanum_juglandifolium','Solanum_dulcamara','Physalis_alkekengi','Physalis_mendocina','Glandularia_flava','Glandularia_aristigera','Stachys_sylvatica','Stachys_argillicola','Randia_petenensis','Randia_grandifolia','Apium_graveolens','Pimpinella_anisum','Chrysanthemum_vestitum','Chrysanthemum_lavandulifolium','Chrysanthemum_weyrichii','Arachis_kretschmeri','Arachis_matiensis','Arachis_valida','Corylus_yunnanensis','Corylus_heterophylla','Corylus_fargesii','Clusia_fructiangusta','Clusia_pallida','Clusia_major','Anaxagorea_panamensis','Anaxagorea_dolichocarpa','Anaxagorea_manausensis','Calyptrogyne_costatifrons','Geonoma_congesta','Asterogyne_martiana','Faurea_macnaughtonii','Protea_neriifolia','Bambusa_tulda','Oxytenanthera_abyssinica','Dendrocalamus_latiflorus','Aegilops_juvenalis','Aegilops_kotschyi','Aegilops_neglecta','Nolana_paradoxa','Nolana_humifusa','Nicotiana_tabacum','Nicotiana_nudicaulis','Nicotiana_palmeri','Echium_lusitanicum','Echium_nervosum','Echium_virescens','Echium_aculeatum','Echium_decaisnei','Echium_hierrense','Castilleja_lineariloba','Castilleja_attenuata','Sutera_hispida','Sutera_revoluta','Sutera_caerulea','Phaneroglossa_bolusii','Eclipta_prostrata','Eupatorium_hyssopifolium','Chrysanthemum_okiense','Chrysanthemum_crassum','Saussurea_thoroldii','Saussurea_stella','Malus_yunnanensis','Malus_x_domestica','Malus_sieversii','Diplocyclos_palmatus','Zehneria_scabra','Populus_deltoides','Populus_maximowiczii','Kobresia_prattii','Kobresia_royleana','Eustachys_distichophylla','Chloris_barbata','Cynodon_arcuatus','Rytidosperma_pauciflorum','Rytidosperma_exiguum','Rytidosperma_telmaticum','Paspalum_acuminatum','Paspalum_vaginatum','Paspalum_urvillei','Veratrum_oblongum','Veratrum_mengtzeanum','Coptis_quinquefolia','Coptis_lutescens','Cephalotaxus_koreana','Cephalotaxus_oliveri','Cephalotaxus_fortunei','Centaurium_scilloides','Centaurium_chloodes','Centaurium_malzacianum','Polyscias_guilfoylei','Hedera_helix','Coriandrum_sativum','Moringa_drouhardii','Pinus_bungeana','Pinus_morrisonicola','Chloroleucon_mangense','Lysiloma_tergeminum','Albizia_julibrissin','Castanopsis_fissa','Castanopsis_carlesii','Castanopsis_cuspidata','Chelyocarpus_ulei','Hemithrinax_compacta','Sorghastrum_nutans','Cymbopogon_citratus','Avena_vaviloviana','Lolium_perenne','Festuca_ovina','Festuca_brevissima','Papaver_somniferum','Ranunculus_macranthus','Menziesia_lasiophylla','Menziesia_multiflora','Brownanthus_kuntzei','Brownanthus_schenckii','Brownanthus_arenosus','Brownanthus_marlothii','Brownanthus_corallinus','Manihot_esculenta','Manihot_brachyloba','Manihot_cecropiifolia','Manihot_rubricaulis','Manihot_pentaphylla','Manihot_peltata','Camellia_limonia','Camellia_euphlebia','Camellia_chrysanthoides','Camellia_flavida','Arisaema_amurense','Arisaema_heterophyllum','Arisaema_speciosum','Eryngium_pristis','Eryngium_sanguisorba','Eryngium_nudicaule','Gaertnera_psychotrioides','Gaertnera_arenaria','Bathysa_peruviana','Ferdinandusa_speciosa','Sonchus_brachylobus','Sonchus_tectifolius','Gossypium_schwendimanii','Gossypium_gossypioides','Gaertnera_edentata','Gaertnera_brevipedicellata','Citrus_indica','Caragana_ordosica','Caragana_dasyphylla','Caragana_stenophylla','Spartium_junceum','Genista_tenera','Narcissus_papyraceus','Narcissus_albimarginatus','Bactris_gasipaes','Acrocomia_aculeata','Paepalanthus_elongatus','Paepalanthus_planifolius','Paspalum_juergensii','Paspalum_haumanii','Bambusa_vulgaris','Thamnocalamus_tessellatus','Leymus_sabulosus','Leymus_akmolinensis','Elymus_tibeticus','Elymus_sibiricus','Androcymbium_asteroides','Androcymbium_eghimocymbion','Androcymbium_huntleyi','Daphnandra_micrantha','Doryphora_sassafras','Laurelia_sempervirens','Mammillaria_elongata','Mammillaria_backebergiana','Mammillaria_haageana','Craibiodendron_yunnanense','Solanum_oplocense','Solanum_raphanifolium','Arum_orientale','Arum_nigrum','Arum_dioscoridis','Tetramerium_peruvianum','Tetramerium_yaquianum','Gentianella_peruviana','Gentianella_quinquefolia','Gentianella_bellidifolia','Eryngium_glossophyllum','Eryngium_buchtienii','Eryngium_maritimum','Lonicera_rupicola','Lonicera_japonica','Lonicera_tangutica','Lomatium_latilobum','Lomatium_ambiguum','Cousinia_pallidivirens','Cousinia_umbrosa','Cousinia_karatavica','Shorea_faguetiana','Shorea_multiflora','Shorea_selanica','Gossypium_klotzschianum','Gossypium_thurberi','Gossypium_laxum','Pyrus_betulifolia','Pyrus_fauriei','Dendrobium_hercoglossum','Dendrobium_capillipes','Oryza_meridionalis','Oryza_nivara','Hordeum_jubatum','Hordeum_lechleri','Hordeum_secalinum','Hordeum_tetraploidum','Trillium_sessile','Trillium_cernuum','Nepenthes_ventricosa','Nepenthes_thorelii','Armeria_hirta','Armeria_berlengensis','Stewartia_serrata','Stewartia_monadelpha','Capsicum_annuum','Capsicum_pubescens','Lithodora_zahnii','Cerinthe_major','Wolffia_borealis','Wolffia_microscopica','Fockea_edulis','Cibirhiza_dhofarensis','Macoubea_guianensis','Tabernaemontana_citrifolia','Carvalhoa_campanulata','Heracleum_dissectifolium','Heracleum_bivittatum','Sonchus_tuberifer','Sonchus_palmensis','Sonchus_canariensis','Cissus_penninervis','Nothocissus_spicifera','Corylopsis_yunnanensis','Corylopsis_spicata','Corylopsis_willmottiae','Shorea_scaberrima','Shorea_seminis','Shorea_javanica','Severinia_buxifolia','Citrus_hongheensis','Toddalia_asiatica','Coleonema_pulchrum','Morus_lhou','Morus_alba','Morus_rotundiloba','Ophrestia_radicosa','Cajanus_cajan','Betula_grossa','Betula_schmidtii','Betula_chichibuensis','Lycium_chinense','Lycium_andersonii','Pyrus_pyraster','Pyrus_salicifolia','Pyrus_cossonii','Clusia_nemorosa','Clusia_tocuchensis','Manglietia_pachyphylla','Manglietia_insignis','Manglietia_rufibarbata','Anaxagorea_pachypetala','Anaxagorea_javanica','Austrodanthonia_racemosa','Austrodanthonia_penicillata','Chimonanthus_praecox','Chimonanthus_zhejiangensis','Phalaris_canariensis','Lolium_temulentum','Androcymbium_cuspidatum','Androcymbium_ciliolatum','Androcymbium_henssenianum','Epimedium_dolichostemon','Epimedium_pubescens','Epimedium_coactum','Tasmannia_glaucifolia','Tasmannia_xerophila','Silene_viscosa','Silene_diclinis','Salsola_monoptera','Salsola_laricifolia','Actinidia_melanandra','Actinidia_eriantha','Actinidia_hemsleyana','Myrsine_salicina','Myrsine_aquilonia','Myrsine_divaricata','Ipomoea_alba','Ipomoea_wrightii','Hyoscyamus_niger','Scopolia_carniolica','Physochlaina_orientalis','Napeanthus_jelskii','Napeanthus_reitzii','Brownanthus_glareicola','Brownanthus_ciliatus','Eryngium_coquimbanum','Eryngium_galioides','Eryngium_vaseyi','Gaertnera_hispida','Gaertnera_pauciflora','Cremanthodium_microglossum','Cremanthodium_decaisnei','Doronicum_reticulatum','Doronicum_kamaonense','Doronicum_orientale','Dahlia_campanulata','Dahlia_pteropoda','Dahlia_neglecta','Dahlia_scapigera','Dahlia_spectabilis','Dahlia_sherffii','Dubautia_waianapanapaensis','Dubautia_arborea','Echium_candicans','Echium_stenosiphon','Blumea_saxatilis','Blumea_lacera','Aeonium_mascaense','Aeonium_holochrysum','Aeonium_gorgoneum','Cicer_montbretii','Cicer_chorassanicum','Cicer_yamashitae','Passiflora_multiflora','Funastrum_utahense','Funastrum_arenarium','Funastrum_odoratum','Macaranga_havilandii','Macaranga_trachyphylla','Macaranga_calcicola','Musa_acuminata','Musa_balbisiana','Musa_ingens','Paspalum_almum','Axonopus_rosengurttii','Bambusa_textilis','Bambusa_tuldoides','Bambusa_membranacea','Achnatherum_robustum','Amelichloa_clandestina','Tinospora_malabarica']
# 519 from the n best approach from first iteration
prune = ['Picea_rubens', 'Picea_torano', 'Picea_maximowiczii', 'Picea_alcoquiana', 'Picea_breweriana', 'Picea_jezoensis', 'Picea_mariana', 'Picea_glehnii', 'Picea_koyamae', 'Picea_omorika', 'Picea_glauca', 'Aegilops_sharonensis', 'Aegilops_uniaristata', 'Dasypyrum_villosum', 'Aegilops_speltoides', 'Aegilops_comosa', 'Hordeum_marinum', 'Aegilops_umbellulata', 'Secale_cereale', 'Aegilops_juvenalis', 'Hordeum_vulgare', 'Aegilops_ventricosa', 'Picea_sitchensis', 'Triticum_urartu', 'Amblyopyrum_muticum', 'Triticum_timopheevii', 'Aegilops_crassa', 'Pinus_koraiensis', 'Picea_engelmannii', 'Triticum_aestivum', 'Picea_schrenkiana', 'Aegilops_kotschyi', 'Picea_orientalis', 'Aegilops_peregrina', 'Pseudoroegneria_stipifolia', 'Triticum_monococcum', 'Aegilops_biuncialis', 'Oryza_sativa_Indica_Group', 'Bromus_catharticus', 'Triticum_ispahanicum', 'Picea_pungens', 'Aegilops_searsii', 'Picea_neoveitchii', 'Pinus_sylvestris', 'Picea_koraiensis', 'Picea_mexicana', 'Picea_abies', 'Picea_obovata', 'Picea_wilsonii', 'Picea_chihuahuana', 'Hordeum_bogdanii', 'Aegilops_tauschii', 'Picea_smithiana', 'Picea_asperata', 'Picea_retroflexa', 'Picea_morrisonicola', 'Pinus_armandii', 'Pinus_mugo', 'Larix_laricina', 'Aegilops_markgrafii', 'Picea_spinulosa', 'Heteranthelium_piliferum', 'Picea_brachytyla', 'Larix_decidua', 'Thinopyrum_bessarabicum', 'Aegilops_longissima', 'Australopyrum_retrofractum', 'Cupressus_austrotibetica', 'Tetraclinis_articulata', 'Aegilops_triuncialis', 'Aegilops_neglecta', 'Bromus_inermis', 'Hordeum_bulbosum', 'Avena_sativa', 'Bromus_rubens', 'Bromus_arvensis', 'Hordeum_erectifolium', 'Triticum_turgidum', 'Picea_meyeri', 'Pinus_albicaulis', 'Pinus_cembra', 'Aegilops_bicornis', 'Cathaya_argyrophylla', 'Widdringtonia_nodiflora', 'Sequoia_sempervirens', 'Glyptostrobus_pensilis', 'Thujopsis_dolabrata', 'Cupressus_cashmeriana', 'Chamaecyparis_formosensis', 'Chamaecyparis_lawsoniana', 'Thuja_occidentalis', 'Calocedrus_decurrens', 'Potamogeton_wrightii', 'Potamogeton_distinctus', 'Potamogeton_obtusifolius', 'Pleioblastus_gramineus', 'Phyllostachys_nigra', 'Guadua_angustifolia', 'Fokienia_hodginsii', 'Hordeum_pusillum', 'Potamogeton_natans', 'Potamogeton_lucens', 'Pinus_bungeana', 'Potamogeton_gramineus', 'Triticum_zhukovskyi', 'Potamogeton_berchtoldii', 'Potamogeton_alpinus', 'Potamogeton_octandrus', 'Encephalartos_princeps', 'Encephalartos_senticosus', 'Encephalartos_natalensis', 'Potamogeton_intortusifolius', 'Rehdera_trinervis', 'Phyla_lanceolata', 'Potamogeton_pusillus', 'Potamogeton_perfoliatus', 'Pseudoroegneria_spicata', 'Potamogeton_praelongus', 'Potamogeton_nodosus', 'Potamogeton_crispus', 'Potamogeton_compressus', 'Potamogeton_maackianus', 'Oligostachyum_sulcatum', 'Brachystachyum_densiflorum', 'Potamogeton_x_orientalis', 'Pinus_sibirica', 'Pinus_strobus', 'Stuckenia_pectinata', 'Potamogeton_zosteriformis', 'Chimonobambusa_marmorea', 'Peridictyon_sanctum', 'Potamogeton_confervoides', 'Potamogeton_oxyphyllus', 'Potamogeton_cristatus', 'Cedrus_deodara', 'Cupressus_gigantea', 'Colocasia_esculenta', 'Pinus_morrisonicola', 'Pinus_tropicalis', 'Fargesia_fungosa', 'Phyllostachys_edulis', 'Picea_purpurea', 'Semiarundinaria_fastuosa', 'Hordeum_jubatum', 'Jubaea_chilensis', 'Lytocaryum_weddellianum', 'Polyandrococos_caudescens', 'Sinobambusa_tootsik', 'Shibataea_chinensis', 'Osmanthus_yunnanensis', 'Osmanthus_marginatus', 'Araucaria_araucana', 'Cocos_nucifera', 'Hibanobambusa_tranquillans', 'Elymus_canadensis', 'Bouchea_fluminensis', 'Neurolepis_elata', 'Pleioblastus_chino', 'Phillyrea_latifolia', 'Pinus_lambertiana', 'Australopyrum_velutinum', 'Pseudosasa_japonica', 'Shibataea_kumasaca', 'Hordeum_murinum', 'Henrardia_persica', 'Pseudoroegneria_gracillima', 'Chimonobambusa_tumidissinoda', 'Pseudoroegneria_strigosa', 'Diostea_juncea', 'Parodianthus_ilicifolius', 'Pariana_radiciflora', 'Microbiota_decussata', 'Larix_occidentalis', 'Lophopyrum_elongatum', 'Encephalartos_villosus', 'Encephalartos_lanatus', 'Encephalartos_inopinus', 'Butia_capitata', 'Ferrocalamus_strictus', 'Encephalartos_humilis', 'Stachytarpheta_cayennensis', 'Attalea_butyracea', 'Indocalamus_longiauritus', 'Dendrobium_wardianum', 'Dendrobium_gibsonii', 'Indocalamus_latifolius', 'Phyllostachys_aurea', 'Sasa_palmata', 'Encephalartos_umbeluziensis', 'Syagrus_glaucescens', 'Solanum_pennellii', 'Solanum_habrochaites', 'Osmanthus_attenuatus', 'Arundinaria_tecta', 'Encephalartos_lehmannii', 'Dendrobium_primulinum', 'Dendrobium_crepidatum', 'Encephalartos_laevifolius', 'Encephalartos_longifolius', 'Osmanthus_delavayi', 'Dendrobium_brymerianum', 'Dendrobium_harveyanum', 'Dendrobium_fimbriatum', 'Pleioblastus_simonii', 'Yushania_alpina', 'Oryza_latifolia', 'Oryza_eichingeri', 'Elymus_sibiricus', 'Encephalartos_ferox', 'Encephalartos_horridus', 'Dendrobium_crumenatum', 'Monocladus_saxatilis', 'Solanum_tuberosum', 'Picconia_excelsa', 'Dendrobium_chrysanthum', 'Bambusa_multiplex', 'Lolium_perenne', 'Pseudotsuga_menziesii', 'Beccariophoenix_madagascariensis', 'Oryza_punctata', 'Pseudoroegneria_tauri', 'Petrea_volubilis', 'Phyllostachys_bambusoides', 'Sasa_kurilensis', 'Eremopyrum_distans', 'Solanum_chilense', 'Solanum_peruvianum', 'Lithospermum_multiflorum', 'Lithospermum_mirabile', 'Fragaria_pentaphylla', 'Fragaria_nubicola', 'Schizostachyum_funghomii', 'Thyrsostachys_oliveri', 'Menstruocalamus_sichuanensis', 'Arundinaria_gigantea', 'Chimonocalamus_pallens', 'Himalayacalamus_intermedius', 'Psathyrostachys_fragilis', 'Hordeum_brachyantherum', 'Hordeum_arizonicum', 'Hordeum_flexuosum', 'Solanum_leptophyes', 'Verbena_officinalis', 'Fraxinus_pennsylvanica', 'Solanum_chacoense', 'Solanum_lycopersicum', 'Fragaria_moschata', 'Bambusa_bambos', 'Cycas_revoluta', 'Bowenia_spectabilis', 'Dioon_spinulosum', 'Attalea_crassispatha', 'Agropyron_cristatum', 'Solanum_lycopersicoides', 'Solanum_neorickii', 'Xeroaloysia_ovatifolia', 'Fragaria_gracilis', 'Critesion_californicum', 'Elymus_glaucus', 'Elymus_mutabilis', 'Encephalartos_heenanii', 'Encephalartos_trispinosus', 'Glandularia_microphylla', 'Thamnocalamus_tessellatus', 'Bambusa_oldhamii', 'Oryza_sativa_Japonica_Group', 'Oryza_longistaminata', 'Eremopyrum_orientale', 'Hordeum_depressum', 'Eremopyrum_bonaepartis', 'Osmanthus_serrulatus', 'Fragaria_viridis', 'Fragaria_nipponica', 'Fragaria_nilgerrensis', 'Bromus_tectorum', 'Leymus_mollis', 'Elymus_ciliaris', 'Aloysia_virgata', 'Osmanthus_fordii', 'Osmanthus_armatus', 'Pseudosasa_amabilis', 'Psathyrostachys_juncea', 'Elymus_caninus', 'Encephalartos_gratus', 'Datura_inoxia', 'Nicotiana_tabacum', 'Capsicum_annuum', 'Osmanthus_heterophyllus', 'Osmanthus_x_fortunei', 'Osmanthus_cooperi', 'Osmanthus_suavis', 'Olea_europaea', 'Fragaria_daltoniana', 'Dendrobium_crystallinum', 'Melocalamus_arrectus', 'Bambusa_vulgaris', 'Oryza_meyeriana', 'Hordeum_pubiflorum', 'Encephalartos_latifrons', 'Dioon_tomasellii', 'Dioon_mejiae', 'Osmanthus_reticulatus', 'Stylosanthes_hamata', 'Stylosanthes_mexicana', 'Citrus_aurantiifolia', 'Citrus_medica', 'Dendrobium_williamsonii', 'Oryza_alta', 'Hordeum_procerum', 'Dioon_angustifolium', 'Hopea_mengarawan', 'Hopea_helferi', 'Dendrobium_hancockii', 'Dendrobium_chrysotoxum', 'Thamnocalamus_spathiflorus', 'Oryza_minuta', 'Leymus_akmolinensis', 'Junellia_juniperina', 'Melocanna_baccifera', 'Pleioblastus_fortunei', 'Chimonobambusa_ningnanica', 'Oryza_rufipogon', 'Fraxinus_ornus', 'Potamogeton_malaianus', 'Stylosanthes_calcicola', 'Brachyelytrum_erectum', 'Hordeum_chilense', 'Citrus_tachibana', 'Citrus_jambhiri', 'Stylosanthes_leiocarpa', 'Dendrobium_loddigesii', 'Chimonobambusa_szechuanensis', 'Chimonobambusa_grandifolia', 'Chimonobambusa_utilis', 'Leymus_erianthus', 'Encephalartos_ghellinckii', 'Encephalartos_dyerianus', 'Larix_griffithiana', 'Larix_mastersiana', 'Fragaria_vesca', 'Stylosanthes_humilis', 'Acidosasa_purpurea', 'Oryza_sativa', 'Oryza_barthii', 'Ceratozamia_miqueliana', 'Bowenia_serrulata', 'Solanum_juglandifolium', 'Solanum_dulcamara', 'Encephalartos_cupidus', 'Hopea_odorata', 'Hordeum_fuegianum', 'Cycas_taitungensis', 'Microcycas_calocoma', 'Buglossoides_purpurocaerulea', 'Lithodora_zahnii', 'Citrus_reticulata', 'Stylosanthes_macrocephala', 'Stylosanthes_pilosa', 'Oryza_nivara', 'Hordeum_comosum', 'Hordeum_cordobense', 'Solanum_cheesmaniae', 'Omphalodes_verna', 'Moltkia_petraea', 'Duranta_erecta', 'Lantana_camara', 'Chionanthus_ramiflorus', 'Coffea_eugenioides', 'Coffea_liberica', 'Larix_kaempferi', 'Dendrobium_jenkinsii', 'Dendrobium_thyrsiflorum', 'Dendrobium_capillipes', 'Oryza_brachyantha', 'Hordeum_muticum', 'Encephalartos_hildebrandtii', 'Echium_vulgare', 'Fragaria_iinumae', 'Dendrobium_aphyllum', 'Dendrobium_devonianum', 'Dendrobium_falconeri', 'Eragrostis_weberbaueri', 'Eragrostis_tenuifolia', 'Oryza_grandiglumis', 'Oryza_ridleyi', 'Hordeum_intercedens', 'Lindelofia_longiflora', 'Trachystemon_orientalis', 'Buglossoides_arvensis', 'Dioon_argenteum', 'Ceratozamia_kuesteriana', 'Dendrobium_kingianum', 'Leersia_tisserantii', 'Oryza_australiensis', 'Oryza_granulata', 'Encephalartos_manikensis', 'Dioon_caputoi', 'Ceratozamia_euryphyllidia', 'Ceratozamia_norstogii', 'Neosinocalamus_affinis', 'Oryza_officinalis', 'Dioon_purpusii', 'Ceratozamia_hildae', 'Manihot_anomala', 'Manihot_fruticulosa', 'Manihot_chlorosticta', 'Picea_likiangensis', 'Picea_crassifolia', 'Butia_yatay', 'Butia_eriospatha', 'Phaenosperma_globosa', 'Glyceria_grandis', 'Glyceria_declinata', 'Hordeum_euclaston', 'Stangeria_eriopus', 'Citrus_hystrix', 'Citrus_aurantium', 'Bulbophyllum_longiflorum', 'Indosasa_sinica', 'Buergersiochloa_bambusoides', 'Glyceria_maxima', 'Hordeum_lechleri', 'Dioon_sonorense', 'Ceratozamia_morettii', 'Ceratozamia_microstrobila', 'Potamogeton_x_malainoides', 'Citrus_junos', 'Citrus_ichangensis', 'Stylosanthes_viscosa', 'Eragrostis_minor', 'Oryza_rhizomatis', 'Hordeum_parodii', 'Hordeum_tetraploidum', 'Lepidozamia_hopei', 'Hopea_nervosa', 'Leersia_oryzoides', 'Dioon_holmgrenii', 'Macrozamia_moorei', 'Encephalartos_barteri', 'Lepidozamia_peroffskyana', 'Hopea_dryobalanoides', 'Hopea_pubescens', 'Severinia_buxifolia', 'Hydriastele_pinangoides', 'Astrocaryum_alatum', 'Rhynchoryza_subulata', 'Thinopyrum_intermedium', 'Kengyilia_batalinii', 'Dioon_califanoi', 'Encephalartos_whitelockii', 'Lycium_bosciifolium', 'Lycium_ferocissimum', 'Solanum_pimpinellifolium', 'Hopea_apiculata', 'Hopea_pierrei', 'Hopea_ferruginea', 'Citrus_latipes', 'Stylosanthes_seabrana', 'Acrocomia_aculeata', 'Cymbopogon_citratus', 'Setaria_italica', 'Oryza_coarctata', 'Glyceria_borealis', 'Hopea_subalata', 'Dendrobium_acinaciforme', 'Dendrobium_officinale', 'Larix_sibirica', 'Hordeum_secalinum', 'Solanum_chmielewskii', 'Lithospermum_latifolium', 'Lithospermum_distichum', 'Dioon_merolae', 'Echidnopsis_leachii', 'Caralluma_bhupinderana', 'Neobalanocarpus_heimii', 'Citrus_maxima', 'Atalantia_ceylanica', 'Passiflora_citrifolia', 'Passiflora_foetida', 'Dendrobium_findlayanum', 'Dendrobium_trigonopus', 'Dypsis_lastelliana', 'Elaeis_oleifera', 'Panicum_bisulcatum', 'Panicum_schinzii', 'Chusquea_coronalis', 'Bambusa_chungii', 'Protea_effusa', 'Protea_laurifolia', 'Nuphar_advena', 'Nuphar_rubrodisca', 'Citrus_limon', 'Manihot_glaziovii', 'Pseudostachyum_polymorphum', 'Hordeum_guatemalense', 'Kengyilia_alatavica', 'Thuja_plicata', 'Primula_bulleyana', 'Primula_cockburniana', 'Potamogeton_robbinsii', 'Hopea_wightiana', 'Citrus_sinensis', 'Nypa_fruticans', 'Ehrharta_calycina', 'Hordeum_stenostachys', 'Myricaria_wardii', 'Myricaria_laxiflora', 'Lithospermum_erythrorhizon', 'Lithospermum_officinale', 'Dioon_edule', 'Dioon_rzedowskii', 'Ceratozamia_sabatoi', 'Anomalluma_mccoyi', 'Caralluma_crenulata', 'Ceropegia_bulbosa', 'Sinapis_alba', 'Brassica_juncea', 'Citrus_macroptera', 'Citrus_halimii', 'Manihot_esculenta', 'Manihot_cecropiifolia', 'Leopoldinia_pulchra', 'Lepturus_repens', 'Pseudopentameris_macrantha', 'Notodanthonia_longifolia', 'Austrodanthonia_tenuior', 'Austrodanthonia_fulva', 'Austrodanthonia_laevis', 'Glyceria_striata', 'Solanum_commersonii', 'Caralluma_priogonium', 'Coffea_arabica', 'Psilanthus_ebracteolatus', 'Coffea_arabica_x_Coffea_liberica', 'Coffea_kapakata', 'Feroniella_oblata', 'Manihot_triphylla', 'Voanioala_gerardii', 'Elaeis_guineensis', 'Lamprothyrsus_peruvianus', 'Cortaderia_fulvida', 'Austrodanthonia_mera', 'Austrodanthonia_popinensis', 'Austrodanthonia_duttoniana', 'Cupressus_funebris', 'Bambusa_tulda', 'Dendrocalamus_latiflorus', 'Pseudoroegneria_geniculata', 'Secale_sylvestre', 'Agropyron_mongolicum', 'Solanum_etuberosum', 'Caralluma_arachnoidea', 'Edithcolea_grandis', 'Caudanthera_edulis', 'Euryops_speciosissimus', 'Euryops_virgineus', 'Crucihimalaya_mollissima', 'Boechera_holboellii', 'Hopea_latifolia', 'Atalantia_monophylla', 'Citrus_gracilis', 'Citrus_celebica', 'Citrus_hongheensis', 'Swinglea_glutinosa', 'Taxus_baccata', 'Passiflora_edulis', 'Manihot_brachyloba', 'Dendrobium_densiflorum', 'Kentiopsis_oliviformis', 'Bactris_gasipaes', 'Barcella_odora', 'Gastrococos_crispa', 'Eragrostis_mexicana', 'Glyceria_nemoralis', 'Leymus_alaicus', 'Avena_ventricosa', 'Osmanthus_matsumuranus', 'Caralluma_sarkariae', 'Caralluma_stalagmifera', 'Coffea_racemosa', 'Brassica_carinata', 'Hopea_discolor', 'Balsamocitrus_dawei', 'Toddalia_asiatica', 'Hesperolinon_micranthum', 'Hesperolinon_clevelandii', 'Neonicholsonia_watsonii', 'Austrodanthonia_induta', 'Austrodanthonia_monticola', 'Juniperus_indica', 'Protea_cynaroides']
delete(file, target_file, prune)

'''



## This is the result for the filtered set (all trees were 1.0 distance)

411 :  ['Picea_rubens', 'Picea_torano', 'Picea_maximowiczii'] 0.988926, 16571
403 :  ['Picea_rubens', 'Picea_torano'] 0.988953, 16572
400 :  ['Picea_rubens', 'Picea_alcoquiana', 'Picea_torano'] 0.987561, 16567
389 :  ['Picea_breweriana', 'Picea_rubens', 'Picea_torano'] 0.989466, 16545
382 :  ['Picea_rubens', 'Picea_torano', 'Picea_jezoensis'] 0.988573, 16491
350 :  ['Picea_rubens', 'Picea_torano', 'Picea_mariana'] 0.989335, 16482
338 :  ['Picea_glehnii', 'Picea_torano'] 0.996386, 16700
329 :  ['Picea_rubens', 'Picea_koyamae', 'Picea_torano'] 0.989924, 16553
323 :  ['Picea_glauca', 'Picea_rubens', 'Picea_torano'] 0.989704, 16436
315 :  ['Aegilops_sharonensis', 'Aegilops_speltoides', 'Dasypyrum_villosum'] 0.987226, 16146

313 :  ['Aegilops_sharonensis', 'Aegilops_uniaristata', 'Dasypyrum_villosum']
310 :  ['Aegilops_sharonensis', 'Aegilops_speltoides']
308 :  ['Hordeum_marinum', 'Aegilops_sharonensis', 'Aegilops_speltoides']
303 :  ['Hordeum_marinum', 'Aegilops_sharonensis', 'Aegilops_uniaristata']
298 :  ['Aegilops_sharonensis', 'Aegilops_uniaristata']
297 :  ['Aegilops_sharonensis', 'Dasypyrum_villosum']
294 :  ['Aegilops_sharonensis', 'Aegilops_speltoides', 'Aegilops_juvenalis']
293 :  ['Hordeum_vulgare', 'Aegilops_sharonensis', 'Aegilops_speltoides']
292 :  ['Aegilops_sharonensis', 'Aegilops_speltoides', 'Aegilops_umbellulata']
291 :  ['Secale_cereale', 'Aegilops_sharonensis', 'Dasypyrum_villosum']

## This is the reduced_stbase

Best  20  dropsets (score, dropset):
289 :  ['Aegilops_sharonensis']
287 :  ['Bromus_catharticus', 'Aegilops_sharonensis']
283 :  ['Aegilops_sharonensis', 'Aegilops_ventricosa']
282 :  ['Aegilops_sharonensis', 'Amblyopyrum_muticum']
281 :  ['Aegilops_sharonensis', 'Aegilops_crassa']
279 :  ['Aegilops_sharonensis', 'Aegilops_kotschyi']
275 :  ['Triticum_ispahanicum', 'Aegilops_sharonensis']
267 :  ['Aegilops_sharonensis', 'Aegilops_biuncialis']
240 :  ['Aegilops_sharonensis', 'Aegilops_speltoides']
236 :  ['Aegilops_sharonensis', 'Triticum_timopheevii']
233 :  ['Pseudoroegneria_stipifolia', 'Aegilops_sharonensis']
216 :  ['Aegilops_sharonensis', 'Aegilops_uniaristata']
204 :  ['Triticum_turgidum', 'Aegilops_sharonensis', 'Triticum_timopheevii']
183 :  ['Bromus_catharticus', 'Aegilops_sharonensis', 'Aegilops_speltoides']
177 :  ['Aegilops_sharonensis', 'Aegilops_speltoides', 'Aegilops_ventricosa']
176 :  ['Aegilops_sharonensis', 'Aegilops_speltoides', 'Aegilops_juvenalis']
122 :  ['Aegilops_sharonensis', 'Aegilops_umbellulata']
111 :  ['Solanum_chilense', 'Solanum_peruvianum']
102 :  ['Aegilops_sharonensis', 'Amblyopyrum_muticum', 'Aegilops_umbellulata']
100 :  ['Solanum_incanum', 'Solanum_elaeagnifolium']


Large Tree: 55473, Number of SmallTrees analyzed: 73744
Before Average RF distance 0.271441

Large Tree: 55473, Number of SmallTrees analyzed: 73461
Average RF distance 0.266747


'''
